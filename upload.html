<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Upload Criteria</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f8f9fa; padding: 40px; display: flex; flex-direction: column; align-items: center; }
    .container { background: white; border-radius: 8px; padding: 30px 40px; max-width: 500px; width: 100%; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 40px; }
    h2 { margin-top: 0; text-align: center; color: #333; }
    label, input, button { display: block; width: 100%; margin-top: 12px; }
    button { background: #007bff; color: white; padding: 10px; border: none; border-radius: 4px; cursor: pointer; margin-top: 20px; }
    button:hover { background: #0056b3; }
    .loading { font-weight: bold; color: #007bff; animation: pulse 1.2s infinite; }
    .info-block p { margin: 4px 0; }
    .copy-icon { cursor: pointer; margin-left: 6px; color: #007bff; }
    .copy-icon:hover { color: #0056b3; }
    @keyframes pulse { 0% {opacity: 0.3;} 50% {opacity: 1;} 100% {opacity: 0.3;} }

    #notify {
      position: fixed;
      top: 20px;
      right: 20px;
      min-width: 260px;
      padding: 15px 20px;
      border-radius: 6px;
      color: white;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      opacity: 0;
      pointer-events: none;
      transform: translateX(120%);
      transition: opacity 0.5s ease, transform 0.5s ease;
      z-index: 3000;
    }
    #notify.show {
      opacity: 1;
      pointer-events: auto;
      transform: translateX(0);
    }
    #notify.success { background-color: #28a745; }
    #notify.error { background-color: #f8d7da; /* delikatna r√≥≈ºowawa czerwie≈Ñ */
  color: #a71d2a; }
    .help-icon {
  position: fixed;
  top: 20px;
  right: 20px;
  background-color: #1a73e8;
  color: white;
  font-size: 18px;
  font-weight: bold;
  width: 30px;
  height: 30px;
  text-align: center;
  line-height: 30px;
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  z-index: 2000;
}

.tooltip-bubble {
  position: fixed;
  top: 60px;
  right: 20px;
  background: white;
  color: #333;
  padding: 14px 18px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  max-width: 300px;
  font-size: 14px;
  line-height: 1.4;
  display: none;
  z-index: 2000;
}
.tooltip-bubble.show {
  display: block;
}

  </style>
</head>
<body>

<a href="/" style="
  display: inline-block;
  margin-bottom: 20px;
  background-color: #1a73e8;
  color: white;
  padding: 10px 18px;
  text-decoration: none;
  border-radius: 6px;
  font-weight: bold;
">
  ‚Üê Back to Main Panel
</a>

<div class="container">
  <h2>Upload Job Offers</h2>
  <form id="uploadForm">
    <label for="criteria_file">Select file (.docx or .pdf):</label>
    <input type="file" id="criteria_file" name="criteria_file" accept=".docx,.pdf" required />
    <button type="submit">Upload</button>
  </form>
  <div id="result"></div>
</div>

<!-- Notify box -->
<div id="notify" role="alert" aria-live="assertive"></div>
<div class="help-icon" id="helpIcon">?</div>
<div class="tooltip-bubble" id="helpTooltip">
On this page, you can submit job offers received from companies.
The system automatically extracts key information, such as company name, position, and requirements, which it then uses to analyze applicants' documents.
  Just click 'Choose file', find the right document in your files and click 'Upload'
</div>
<script>
const uploadForm = document.getElementById("uploadForm");
const resultDiv = document.getElementById("result");
const notify = document.getElementById("notify");

uploadForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  resultDiv.innerHTML = '<p class="loading">‚è≥ Uploading and analyzing...</p>';

  const formData = new FormData();
  const fileInput = document.getElementById("criteria_file");
  formData.append("criteria_file", fileInput.files[0]);

  try {
    const response = await fetch("/upload_criteria/", {
      method: "POST",
      body: formData
    });

    if (response.ok) {
      const data = await response.json();
      resultDiv.innerHTML = `
        <p class="success">‚úÖ Upload successful!</p>
        <div class="info-block">
          <p><strong>Form ID:</strong> <span id="formId">${data.form_id}</span> <span class="copy-icon" onclick="copyToClipboard('formId', this)">üìã</span></p>
          <p><strong>Company:</strong> ${data.company}</p>
          <p><strong>Position:</strong> ${data.position}</p>
        </div>`;
      showNotify("Upload successful!", "success");
    } else {
      const text = await response.text();
      showNotify(text, "error");
      resultDiv.innerHTML = '';
    }
  } catch (error) {
    showNotify("Network error. Please try again.", "error");
    resultDiv.innerHTML = '';
  }
});

function copyToClipboard(elementId, iconElement) {
  const text = document.getElementById(elementId).textContent;
  navigator.clipboard.writeText(text).then(() => {
    const original = iconElement.textContent;
    iconElement.textContent = "‚úÖ";
    setTimeout(() => { iconElement.textContent = original; }, 1500);
  });
}

let notifyTimeout;
function showNotify(message, type = "success") {
  clearTimeout(notifyTimeout);
  notify.textContent = message;
  notify.className = '';
  notify.classList.add(type);
  notify.classList.add("show");
  notifyTimeout = setTimeout(() => {
    notify.classList.remove("show");
  }, 4000);
}
const helpIcon = document.getElementById("helpIcon");
const helpTooltip = document.getElementById("helpTooltip");

helpIcon.addEventListener("click", () => {
  helpTooltip.classList.toggle("show");
});

document.addEventListener("click", (e) => {
  if (!helpIcon.contains(e.target) && !helpTooltip.contains(e.target)) {
    helpTooltip.classList.remove("show");
  }
});
</script>
</body>
</html>
